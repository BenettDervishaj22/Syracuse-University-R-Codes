knitr::opts_chunk$set(echo = TRUE)
Model2_Revised <- lm(aveprice ~ Sun+Mon+Tue+Thu+Fri+Sat+Apr+May+July+Aug+Sept+Windspeed+Temp+aft+earlyeve+opday+div+int+chc+nyy+phi,data = mets)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(tseries)
library(foreign)
library(urca)
library(car)
library(rpart)
library(rpart.plot)
library(lmtest)
library(sandwich)
library(dynlm)
mets <- read.csv("Mets_Dynamic.csv")
# Mets Model
model1 <- lm(aveprice ~ Sun+Mon+Tue+Thu+Fri+Sat+Apr+May+July+Aug+Sept+winpct+vwp+Windspeed+Temp+aft+earlyeve+opday+div+int,data = mets)
summary(model1)
# Overall, the model as a whole is significant at the 1%  level. The most significant variables in this model are Tuesday (10% level), Friday (1% level), Saturday (1% level), May (10% level), Temperature (5% level), Opening Day (1% level), and inter league games (1% level). We reject the null hypothesis based on this initial regression test.
# Coefficients
# Tuesday: Games on Tuesdays seem to decrease the average price by $9.9374.
# Friday: Games on Fridays seem to increase the average price by $25.3813.
# Saturday: Games on Saturdays seem to increase the average price by $21.6470.
# May: Games in May seem to decrease the average  price by $12.1717.
# Temperature: Higher temperature games tend to increase the average price by $0.6970.
# Opening Day: Opening Day game significantly increases the average price by $77.3265.
# Inter-league Games: Inter-league games increases the average price by $22.7254.
# Model with CHC, NYY, PHI Variables
model2 <- lm(aveprice ~ Sun+Mon+Tue+Thu+Fri+Sat+Apr+May+July+Aug+Sept+winpct+vwp+Windspeed+Temp+aft+earlyeve+opday+div+int+chc+nyy+phi,data = mets)
summary(model2)
# Overall, the model as a whole is significant at the 1% level. The most significant variables in this model are: Tuesday (10% level), Friday (1% level), Saturday (1% level), Temperature (1% level), Opening Day (1% level), and the New York Yankees dummy variable (110% level). We reject the null hypothesis based on this initial regression test.
# Coefficients
# Tuesday: Games on Tuesdays tend to decrease the average price by $10.0997.
# Friday: Games on Fridays tend to increase the average price by $22.7452.
# Saturday: Games on Saturdays tend to increase the average price by $17.7341.
# May: Games in May tend to decrease the average price by $12.6307.
# Temperature: Higher temperature games tend to increase the average price by $0.8026.
# Opening Day: Opening Day game significantly increases the average price by $78.2666
# NYY: Games against the New York Yankees significantly increases the average price by $22.1945.
# Testing for Multicollinearity
vif(model2)
# Variables that exhibit Multicollinearity: Win Pct and VWP both exceed the value of 5, therefore we need to remove them from this model and re-run the new regression to see any potential changes to the significance.
Model2_Revised <- lm(aveprice ~ Sun+Mon+Tue+Thu+Fri+Sat+Apr+May+July+Aug+Sept+Windspeed+Temp+aft+earlyeve+opday+div+int+chc+nyy+phi,data = mets)
summary(Model2_Revised)
# Overall, the model as a whole is significant at the 1% level. The most significant variables in this model are Friday (1% level), Saturday (1% level), May (10% level), Temperature (1% level), Opening Day (1% level), and NYY (10% level).
# Coefficients
# Friday: Games on Fridays increase the average price by $24.08398.
# Saturday: Games on Saturdays increase the average price by $18.54739.
# May: Games in May decrease the average price by $11.01385.
# Temperature: Higher temperature games increase the average price by $0.82710.
# Opening Day: Opening Day game significantly increases the average price by $74.81431.
# NYY: Games against the New York Yankees increases the average price by $21.38664.
# Durbin-Watson Test
dwtest(Model2_Revised)
# The DW value of 1.845 is quite close to 2, which would be considered a non-issue. However since it is below 2, thus making it closer to 0, we can correct for autocorrelation.
# Newey-West Standard Errors
coeftest(Model2_Revised, vcovHAC)
# Results
# The significant variables are now Friday (1% level), Saturday (1% level), May (5% level), Sept (10% level), Temperature (10% level), and Opening DAY (1% level). This is different from the previous 2 models, which indicates that correcting for autocorrelation, multicollinearity, and heteroskedasticity has changed the output of the model, somewhat signficantly.
# Coefficients
# Friday: Games on Fridays increase the average price by $24.083984.
# Saturday: Games on Saturdays increase the average price by $18.547394.
# May: Games in May decrease the average price by $11.013849.
# Sept: Games in September decrease the average price by $9.395335.
# Temperature: Higher temperature games increase the average price by $0.827101.
# Opening Day: Opening Day game significantly increases the average price by $74.814310.
Model2_Revised <- lm(aveprice ~ Sun+Mon+Tue+Thu+Fri+Sat+Apr+May+July+Aug+Sept+Windspeed+Temp+aft+earlyeve+opday+div+int+chc+nyy+phi,data = mets)
summary(Model2_Revised)
coeftest(Model2_Revised, vcovHAC)
