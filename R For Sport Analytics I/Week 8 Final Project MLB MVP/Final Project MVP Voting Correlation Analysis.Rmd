---
title: "Final Project"
author: "Derek Cunius"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Determining Which Batting Statistics Most Correlate with MVP Voting Decisions

```{r}
library(tidyverse)
library(ggrepel)
```

# Creating a Data Frame With Necessary Player Statistics from MVP Season
```{r}
# Note: All Stats Collected from Baseball Reference

PLAYER <- c("Aaron Judge, 2024", "Shohei Ohtani, 2024", "Shohei Ohtani, 2023", "Ronald Acuna, 2023", "Aaron Judge, 2022", "Paul Goldschmidt, 2022", "Shohei Ohtani, 2021", "Bryce Harper, 2021", "Mike Trout, 2019", "Cody Bellinger, 2019", "Mookie Betts, 2018", "Christian Yelich, 2018", "Jose Altuve, 2017", "Giancarlo Stanton, 2017", "Mike Trout, 2016", "Kris Bryant, 2016", "Josh Donaldson, 2015", "Bryce Harper, 2015")

RBI <- c(144, 130, 95, 106, 131, 115, 100, 84, 104, 115, 80, 110, 81, 132, 100, 102, 123, 99)

R <- c(122, 134, 102, 149, 133, 106, 103, 101, 110, 121, 129, 118, 112, 123, 123, 121, 122, 118)

TmR <- c(815, 842, 739, 947, 807, 772, 723, 734, 769, 886, 876, 754, 896, 778, 717, 808, 891, 703)

HR <- c(58, 54, 44, 41, 62, 35, 46, 35, 45, 47, 32, 36, 24, 59, 29, 39, 41, 42)

HITS <- c(180, 197, 151, 217, 177, 178, 138, 151, 137, 170, 180, 187, 204, 168, 173, 176, 184, 172)

TB <- c(392, 411, 325, 383, 391, 324, 318, 300, 303, 351, 333, 343, 323, 377, 302, 334, 352, 338)

BB <- c(133, 81, 91, 80, 111, 79, 96, 100, 110, 95, 81, 68, 58, 85, 116, 75, 73, 124)

AB <- c(559, 636, 497, 643, 570, 561, 537, 488, 470, 558, 520, 574, 590, 597, 549, 603, 620, 521)

AVG <- c(.322, .310, .304, .337, .311, .317, .257, .309, .291, .305, .346, .326, .346, .281, .315, .292, .297, .330)

OBP <- c(.458, .390, .412, .416, .425, .404, .372, .429, .438, .406, .438, .402, .410, .376, .441, .385, .371, .460)

OPS <- c(1.159, 1.036, 1.066, 1.012, 1.111, .981, .965, 1.044, 1.083, 1.035, 1.078, 1.000, .957, 1.007, .991, .939, .939, 1.109)

WAR <- c(10.8, 9.2, 6.0, 8.2, 10.5, 7.7, 4.9, 5.9, 7.9, 8.6, 10.7, 7.3, 7.7, 7.9, 10.5, 7.3, 7.1, 9.7)

VOTES <- c(30, 30, 30, 30, 28, 22, 30, 17, 17, 19, 28, 29, 27, 10, 19, 29, 23, 30)

MVPStats <- data.frame(PlayerNameandYear = PLAYER, RBI = RBI, R = R, TeamRuns = TmR, HR = HR, H = HITS, TB = TB, BB = BB, AB = AB, BAVG = AVG, OBP = OBP, OPS = OPS, WAR = WAR, MVPFirstPlaceVotes = VOTES)
```

# Adding the Bill James Run Created Formula to the Data Frame 
```{r}
MVPStats <- MVPStats %>% mutate(JamesRC = (((H + BB) * TB)/ (AB + BB)))
```

# Adding a Runs Accounted For Column and Percentage of Team Runs Accounted For Column
```{r}
# Ensure that Runs and RBIs due to Home Runs are not Double Counted
MVPStats <- MVPStats %>% mutate(RunsAccountedFor = (R - HR) + RBI)

# Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(PercentTmRunsAccountedFor = RunsAccountedFor/TeamRuns)
```

# Creating a Scatter Plot to Analyze the Correlation Between the Percentage of Team Runs Accounted for and 1st Place MVP Votes 
```{r}
# Calculating the Pearson Correlation r
TmRunsAccountedCorrelation <- cor(MVPStats$PercentTmRunsAccountedFor, MVPStats$MVPFirstPlaceVotes)

# Determining Which Players are the Top and Bottom 2 in Terms of Percentage of Team Runs Accounted For 
Top2TmRunsAcct <- MVPStats %>% arrange(desc(PercentTmRunsAccountedFor)) %>% head(2)
Bottom2TmRunsAcct <- MVPStats %>% arrange(desc(PercentTmRunsAccountedFor)) %>% tail(2)

# Adding A new Column to MVP Stats to Assign Groups Based on Top or Bottom 2 of Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(RankAccountedTmRuns = case_when(
  PlayerNameandYear %in% Top2TmRunsAcct$PlayerNameandYear ~ "Top 2",
  PlayerNameandYear %in% Bottom2TmRunsAcct$PlayerNameandYear ~ "Bottom 2",
  TRUE ~ "Other"))

ggplot(MVPStats, aes(x = PercentTmRunsAccountedFor, y = MVPFirstPlaceVotes)) +
  geom_point(aes(color = RankAccountedTmRuns)) +
  
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  
  annotate("text", x = 0.2125, y = 12,
           label = paste("r-value =", round(TmRunsAccountedCorrelation, 2)),
           size = 6, color = "black") +
  
  xlab("Percentage of Team Runs Accounted For") + ylab("Number of First Place MLB Votes") +
  
  ggtitle("Correlation Between % of Team Runs Accounted for and 1st Place MVP Votes") +
  
  geom_text_repel(data = Top2TmRunsAcct, color = "black", nudge_y = 1, aes(label = paste(PlayerNameandYear, round(PercentTmRunsAccountedFor, 2), MVPFirstPlaceVotes))) +
  
  geom_text_repel(data = Bottom2TmRunsAcct, color = "black", aes(label = paste(PlayerNameandYear, round(PercentTmRunsAccountedFor, 2), MVPFirstPlaceVotes))) +
  
  scale_color_manual(values = c("Top 2" = "green", "Bottom 2" = "red", "Other" = "black"))
```

# Creating a Scatter Plot to Analyze the Correlation Between Runs Accounted for and 1st Place MVP Votes
```{r}
# Calculating the Pearson Correlation r
RunsAccountedCorrelation <- cor(MVPStats$RunsAccountedFor, MVPStats$MVPFirstPlaceVotes)

# Determining Which Players are the Top and Bottom 2 in Terms of Percentage of Team Runs Accounted For 
Top2RunsAcct <- MVPStats %>% arrange(desc(RunsAccountedFor)) %>% head(2)
Bottom2RunsAcct <- MVPStats %>% arrange(desc(RunsAccountedFor)) %>% tail(2)

# Adding A new Column to MVP Stats to Assign Groups Based on Top or Bottom 2 of Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(RankAccountedRuns = case_when(
  PlayerNameandYear %in% Top2RunsAcct$PlayerNameandYear ~ "Top 2",
  PlayerNameandYear %in% Bottom2RunsAcct$PlayerNameandYear ~ "Bottom 2",
  TRUE ~ "Other"))

ggplot(MVPStats, aes(x = RunsAccountedFor, y = MVPFirstPlaceVotes)) +
  geom_point(aes(color = RankAccountedRuns)) +
  
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  
  annotate("text", x = 180, y = 12,
           label = paste("r-value =", round(RunsAccountedCorrelation, 2)),
           size = 6, color = "black") +
  
  xlab("Runs Accounted For") + ylab("Number of First Place MLB Votes") +
  
  ggtitle("Correlation Between Runs Accounted for and 1st Place MVP Votes") +
  
  geom_text_repel(data = Top2RunsAcct, color = "black", nudge_y = 3, aes(label = paste(PlayerNameandYear, RunsAccountedFor, MVPFirstPlaceVotes))) +
  
  geom_text_repel(data = Bottom2RunsAcct, color = "black", nudge_y = 2, aes(label = paste(PlayerNameandYear, RunsAccountedFor, MVPFirstPlaceVotes))) +
  
  scale_color_manual(values = c("Top 2" = "green", "Bottom 2" = "red", "Other" = "black"))
```

# Creating a Scatter Plot to Analyze the Correlation Between James' Runs Created and 1st Place MVP Votes
```{r}
# Calculating the Pearson Correlation r
JamesRCCorrelation <- cor(MVPStats$JamesRC, MVPStats$MVPFirstPlaceVotes)

# Determining Which Players are the Top and Bottom 2 in Terms of Percentage of Team Runs Accounted For 
Top2JamesRC <- MVPStats %>% arrange(desc(JamesRC)) %>% head(2)
Bottom2JamesRC <- MVPStats %>% arrange(desc(JamesRC)) %>% tail(2)

# Adding A new Column to MVP Stats to Assign Groups Based on Top or Bottom 2 of Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(RankJamesRC = case_when(
  PlayerNameandYear %in% Top2JamesRC$PlayerNameandYear ~ "Top 2",
  PlayerNameandYear %in% Bottom2JamesRC$PlayerNameandYear ~ "Bottom 2",
  TRUE ~ "Other"))

ggplot(MVPStats, aes(x = JamesRC, y = MVPFirstPlaceVotes)) +
  geom_point(aes(color = RankJamesRC)) +
  
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  
  annotate("text", x = 165, y = 14,
           label = paste("r-value =", round(JamesRCCorrelation, 2)),
           size = 6, color = "black") +
  
  xlab("Runs Created According to James' Equation") + ylab("Number of First Place MLB Votes") +
  
  ggtitle("Correlation Between Runs Created and 1st Place MVP Votes") +
  
  geom_text_repel(data = Top2JamesRC, color = "black", nudge_y = 3, aes(label = paste(PlayerNameandYear, round(JamesRC, 0), MVPFirstPlaceVotes))) +
  
  geom_text_repel(data = Bottom2JamesRC, color = "black", nudge_y = 1, aes(label = paste(PlayerNameandYear, round(JamesRC, 0), MVPFirstPlaceVotes))) +
  
  scale_color_manual(values = c("Top 2" = "green", "Bottom 2" = "red", "Other" = "black"))
```


# Creating a Scatter Plot to Analyze the Correlation Between Player OPS and 1st Place MVP Votes
```{r}
# Calculating the Pearson Correlation r
OPSCorrelation <- cor(MVPStats$OPS, MVPStats$MVPFirstPlaceVotes)

# Determining Which Players are the Top and Bottom 2 in Terms of Percentage of Team Runs Accounted For 
Top2OPS <- MVPStats %>% arrange(desc(OPS)) %>% head(2)
Bottom2OPS <- MVPStats %>% arrange(desc(OPS)) %>% tail(2)

# Adding A new Column to MVP Stats to Assign Groups Based on Top or Bottom 2 of Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(RankOPS = case_when(
  PlayerNameandYear %in% Top2OPS$PlayerNameandYear ~ "Top 2",
  PlayerNameandYear %in% Bottom2OPS$PlayerNameandYear ~ "Bottom 2",
  TRUE ~ "Other"))

ggplot(MVPStats, aes(x = OPS, y = MVPFirstPlaceVotes)) +
  geom_point(aes(color = RankOPS)) +
  
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  
  annotate("text", x = 1.1, y = 14,
           label = paste("r-value =", round(OPSCorrelation, 2)),
           size = 6, color = "black") +
  
  xlab("On-Base Plus Slugging Percentage") + ylab("Number of First Place MLB Votes") +
  
  ggtitle("Correlation Between OPS and 1st Place MVP Votes") +
  
  geom_text_repel(data = Top2OPS, color = "black", nudge_y = -1, aes(label = paste(PlayerNameandYear, round(OPS, 2), MVPFirstPlaceVotes))) +
  
  geom_text_repel(data = Bottom2OPS, color = "black", nudge_y = -0.125, aes(label = paste(PlayerNameandYear, round(OPS, 2), MVPFirstPlaceVotes))) +
  
  scale_color_manual(values = c("Top 2" = "green", "Bottom 2" = "red", "Other" = "black"))
```

# Creating a Scatter Plot to Analyze the Correlation Between WAR and 1st Place MVP Votes
```{r}
# Calculating the Pearson Correlation r
WARCorrelation <- cor(MVPStats$WAR, MVPStats$MVPFirstPlaceVotes)

# Determining Which Players are the Top and Bottom 2 in Terms of Percentage of Team Runs Accounted For 
Top2WAR <- MVPStats %>% arrange(desc(WAR)) %>% head(2)
Bottom2WAR <- MVPStats %>% arrange(desc(WAR)) %>% tail(2)

# Adding A new Column to MVP Stats to Assign Groups Based on Top or Bottom 2 of Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(RankWAR = case_when(
  PlayerNameandYear %in% Top2WAR$PlayerNameandYear ~ "Top 2",
  PlayerNameandYear %in% Bottom2WAR$PlayerNameandYear ~ "Bottom 2",
  TRUE ~ "Other"))

ggplot(MVPStats, aes(x = WAR, y = MVPFirstPlaceVotes)) +
  geom_point(aes(color = RankWAR)) +
  
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  
  annotate("text", x = 9.5, y = 14,
           label = paste("r-value =", round(WARCorrelation, 2)),
           size = 6, color = "black") +
  
  xlab("Wins Above Replacement") + ylab("Number of First Place MLB Votes") +
  
  ggtitle("Correlation Between WAR and 1st Place MVP Votes") +
  
  geom_text_repel(data = Top2WAR, color = "black", nudge_y = -1, aes(label = paste(PlayerNameandYear, round(WAR, 1), MVPFirstPlaceVotes))) +
  
  geom_text_repel(data = Bottom2WAR, color = "black", nudge_y = 1, aes(label = paste(PlayerNameandYear, round(WAR, 1), MVPFirstPlaceVotes))) +
  
  scale_color_manual(values = c("Top 2" = "green", "Bottom 2" = "red", "Other" = "black"))
```

# Creating a Scatter Plot to Analyze the Correlation Between Home Runs and 1st Place MVP Votes
```{r}
# Calculating the Pearson Correlation r
HRCorrelation <- cor(MVPStats$HR, MVPStats$MVPFirstPlaceVotes)

# Determining Which Players are the Top and Bottom 2 in Terms of Percentage of Team Runs Accounted For 
Top2HR <- MVPStats %>% arrange(desc(HR)) %>% head(2)
Bottom2HR <- MVPStats %>% arrange(desc(HR)) %>% tail(2)

# Adding A new Column to MVP Stats to Assign Groups Based on Top or Bottom 2 of Percentage of Team Runs Accounted For 
MVPStats <- MVPStats %>% mutate(RankHR = case_when(
  PlayerNameandYear %in% Top2HR$PlayerNameandYear ~ "Top 2",
  PlayerNameandYear %in% Bottom2HR$PlayerNameandYear ~ "Bottom 2",
  TRUE ~ "Other"))

ggplot(MVPStats, aes(x = HR, y = MVPFirstPlaceVotes)) +
  geom_point(aes(color = RankHR)) +
  
  geom_smooth(method = "lm", color = "black", se = FALSE) +
  
  annotate("text", x = 35, y = 14,
           label = paste("r-value =", round(HRCorrelation, 2)),
           size = 6, color = "black") +
  
  xlab("Home Runs") + ylab("Number of First Place MLB Votes") +
  
  ggtitle("Correlation Between Home Runs and 1st Place MVP Votes") +
  
  geom_text_repel(data = Top2HR, color = "black", aes(label = paste(PlayerNameandYear, HR, MVPFirstPlaceVotes))) +
  
  geom_text_repel(data = Bottom2HR, color = "black", aes(label = paste(PlayerNameandYear, HR, MVPFirstPlaceVotes))) +
  
  scale_color_manual(values = c("Top 2" = "green", "Bottom 2" = "red", "Other" = "black"))
```

# Conclusion of Analysis
```{r}
# Bill James' Runs Created Equation has the strongest correlation with MVP First Place voting. As a player creates more runs according to James, their MVP votes increase. There are other slightly positive correlations for other areas such as OPS, WAR, and Runs Accounted For. Surprisingly, there is a slightly negative correlation when looking at Home Runs and Percentage of Team Runs Accounted For compared to First Place MVP Votes. The voting committee does not seem to value how the MVP affects their team's success. 
```


# Writing New Data Frame With Stat Rankings to CSV 
```{r}
write_csv(MVPStats, "FinalProjectMVPStats.csv")
```

